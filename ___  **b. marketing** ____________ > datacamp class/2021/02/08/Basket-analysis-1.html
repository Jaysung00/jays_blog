<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Market Basket Analysis in Python ① | Jay Sung’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Market Basket Analysis in Python ①" />
<meta name="author" content="Jay Sung" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Market Basket Analysis in Python ①Introduction to Market Basket Analysis まとめ, via Datacamp" />
<meta property="og:description" content="Market Basket Analysis in Python ①Introduction to Market Basket Analysis まとめ, via Datacamp" />
<link rel="canonical" href="https://jaysung00.github.io/jays_blog/___%20%20**b.%20marketing**%20____________%20%3E%20datacamp%20class/2021/02/08/Basket-analysis-1.html" />
<meta property="og:url" content="https://jaysung00.github.io/jays_blog/___%20%20**b.%20marketing**%20____________%20%3E%20datacamp%20class/2021/02/08/Basket-analysis-1.html" />
<meta property="og:site_name" content="Jay Sung’s Blog" />
<meta property="og:image" content="https://jaysung00.github.io/jays_blog/images/basket.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-08T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://jaysung00.github.io/jays_blog/___%20%20**b.%20marketing**%20____________%20%3E%20datacamp%20class/2021/02/08/Basket-analysis-1.html","@type":"BlogPosting","headline":"Market Basket Analysis in Python ①","dateModified":"2021-02-08T00:00:00-06:00","datePublished":"2021-02-08T00:00:00-06:00","image":"https://jaysung00.github.io/jays_blog/images/basket.png","author":{"@type":"Person","name":"Jay Sung"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jaysung00.github.io/jays_blog/___%20%20**b.%20marketing**%20____________%20%3E%20datacamp%20class/2021/02/08/Basket-analysis-1.html"},"description":"Market Basket Analysis in Python ①Introduction to Market Basket Analysis まとめ, via Datacamp","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/jays_blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://jaysung00.github.io/jays_blog/feed.xml" title="Jay Sung's Blog" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','pub-3394438931488678','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/jays_blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/jays_blog/">Jay Sung&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/jays_blog/about/">About Me</a><a class="page-link" href="/jays_blog/search/">Search</a><a class="page-link" href="/jays_blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Market Basket Analysis in Python ①</h1><p class="page-description"><a href='https://learn.datacamp.com/courses/market-basket-analysis-in-python'>Market Basket Analysis in Python ①Introduction to Market Basket Analysis</a> まとめ, via Datacamp</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-02-08T00:00:00-06:00" itemprop="datePublished">
        Feb 8, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Jay Sung</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/jays_blog/categories/#___  **B. MARKETING** ____________ > Datacamp Class">___  **B. MARKETING** ____________ > Datacamp Class</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#バスケット分析とは？">バスケット分析とは？ </a>
<ul>
<li class="toc-entry toc-h3"><a href="#1.-併売分析">1. 併売分析 </a></li>
<li class="toc-entry toc-h3"><a href="#2.-併売分析に基づいて有用な推奨事項の提供">2. 併売分析に基づいて有用な推奨事項の提供 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#バスケット分析の使用例">バスケット分析の使用例 </a></li>
<li class="toc-entry toc-h2"><a href="#バスケット分析の方法">バスケット分析の方法 </a></li>
<li class="toc-entry toc-h2"><a href="#(実装)-クロルセル製品選択">(実装) クロルセル製品選択 </a></li>
<li class="toc-entry toc-h2"><a href="#Association-Rulesの全ての候補を確認する">Association Rulesの全ての候補を確認する </a>
<ul>
<li class="toc-entry toc-h3"><a href="#データの準備">データの準備 </a></li>
<li class="toc-entry toc-h3"><a href="#Association-rulesの生成">Association rulesの生成 </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Metric-&-Pruning">Metric &amp; Pruning </a>
<ul>
<li class="toc-entry toc-h3"><a href="#One-hot-encoding-transaction-data">One-hot encoding transaction data </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-02-08-Basket-analysis-1.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="バスケット分析とは？">
<a class="anchor" href="#%E3%83%90%E3%82%B9%E3%82%B1%E3%83%83%E3%83%88%E5%88%86%E6%9E%90%E3%81%A8%E3%81%AF%EF%BC%9F" aria-hidden="true"><span class="octicon octicon-link"></span></a>バスケット分析とは？<a class="anchor-link" href="#%E3%83%90%E3%82%B9%E3%82%B1%E3%83%83%E3%83%88%E5%88%86%E6%9E%90%E3%81%A8%E3%81%AF%EF%BC%9F"> </a>
</h2>
<p>バスケット分析によって以下のようなことができる。</p>
<h3 id="1.-併売分析">
<a class="anchor" href="#1.-%E4%BD%B5%E5%A3%B2%E5%88%86%E6%9E%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. 併売分析<a class="anchor-link" href="#1.-%E4%BD%B5%E5%A3%B2%E5%88%86%E6%9E%90"> </a>
</h3>
<p>一回の買い物でよく一緒に買われるものは何か？</p>
<h3 id="2.-併売分析に基づいて有用な推奨事項の提供">
<a class="anchor" href="#2.-%E4%BD%B5%E5%A3%B2%E5%88%86%E6%9E%90%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%84%E3%81%A6%E6%9C%89%E7%94%A8%E3%81%AA%E6%8E%A8%E5%A5%A8%E4%BA%8B%E9%A0%85%E3%81%AE%E6%8F%90%E4%BE%9B" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. 併売分析に基づいて有用な推奨事項の提供<a class="anchor-link" href="#2.-%E4%BD%B5%E5%A3%B2%E5%88%86%E6%9E%90%E3%81%AB%E5%9F%BA%E3%81%A5%E3%81%84%E3%81%A6%E6%9C%89%E7%94%A8%E3%81%AA%E6%8E%A8%E5%A5%A8%E4%BA%8B%E9%A0%85%E3%81%AE%E6%8F%90%E4%BE%9B"> </a>
</h3>
<p>e.g.<br>
・棚の近くに置くべき商品カテゴリー<br>
・棚の遠くに置くべき商品カテゴリー など</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="バスケット分析の使用例">
<a class="anchor" href="#%E3%83%90%E3%82%B9%E3%82%B1%E3%83%83%E3%83%88%E5%88%86%E6%9E%90%E3%81%AE%E4%BD%BF%E7%94%A8%E4%BE%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>バスケット分析の使用例<a class="anchor-link" href="#%E3%83%90%E3%82%B9%E3%82%B1%E3%83%83%E3%83%88%E5%88%86%E6%9E%90%E3%81%AE%E4%BD%BF%E7%94%A8%E4%BE%8B"> </a>
</h2>
<p>e.g.<br>
・Netflixスタイルの推奨エンジン<br>
・eコマースにおける商品推奨の改善<br>
・小売店でのクロスセル（Cross-sell$^{[*1]}$）製品<br>
・在庫管理の改善<br>
・アップセル（Up-sell$^{[*2]}$）するアイテム選択　など</p>
<p><br></p>
<p><span style="font-size: 85%"> 
    $^{[*1]}$ Cross-sell :  顧客が購買する、あるいはすでに利用している製品・サービスに関連するものを販売していくこと<br>
    $^{[*2]}$ Up-sell : 顧客が検討しているものよりランクの高い製品・サービスの販売をすること&lt;/p&gt;
<p>&lt;/span&gt;</p>

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="バスケット分析の方法">
<a class="anchor" href="#%E3%83%90%E3%82%B9%E3%82%B1%E3%83%83%E3%83%88%E5%88%86%E6%9E%90%E3%81%AE%E6%96%B9%E6%B3%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>バスケット分析の方法<a class="anchor-link" href="#%E3%83%90%E3%82%B9%E3%82%B1%E3%83%83%E3%83%88%E5%88%86%E6%9E%90%E3%81%AE%E6%96%B9%E6%B3%95"> </a>
</h2>
<p><strong>Association Rule</strong> によって構成される</p>
<p>・{A} $\rightarrow$ {B}</p>
<p>「Aを買うと、Bを買う」という意味</p>
<hr>
<h2 id="(実装)-クロルセル製品選択">
<a class="anchor" href="#(%E5%AE%9F%E8%A3%85)-%E3%82%AF%E3%83%AD%E3%83%AB%E3%82%BB%E3%83%AB%E8%A3%BD%E5%93%81%E9%81%B8%E6%8A%9E" aria-hidden="true"><span class="octicon octicon-link"></span></a>(実装) クロルセル製品選択<a class="anchor-link" href="#(%E5%AE%9F%E8%A3%85)-%E3%82%AF%E3%83%AD%E3%83%AB%E3%82%BB%E3%83%AB%E8%A3%BD%E5%93%81%E9%81%B8%E6%8A%9E"> </a>
</h2>
<p>小売店ではガムをコーヒーかシリアルかパンかどれかとクロスセルしようとしている。</p>
<p>・{coffee} $\rightarrow$ {gum}<br>
・{cereal} $\rightarrow$ {gum}<br>
・{bread} $\rightarrow$ {gum}  のうち、最も関係性が強いものを選びたい。</p>
<p><br></p>
<p><code>transactions</code>は ['coffee','gum'] &amp; ['cereal','gum'] &amp; ['bread','gum'] の３つのペアからなっている。</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import &amp; read data</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">transactions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/transactions.csv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">transactions</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>bread</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bread</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>2</th>
      <td>cereal</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>3</th>
      <td>coffee</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>4</th>
      <td>bread</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>80</th>
      <td>bread</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>81</th>
      <td>coffee</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>82</th>
      <td>bread</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>83</th>
      <td>coffee</td>
      <td>gum</td>
    </tr>
    <tr>
      <th>84</th>
      <td>coffee</td>
      <td>gum</td>
    </tr>
  </tbody>
</table>
<p>85 rows × 2 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>各ペアの数をカウントする</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Count the number of transactions with coffee and gum</span>
<span class="n">coffee</span> <span class="o">=</span> <span class="n">transactions</span><span class="p">[(</span><span class="n">transactions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'coffee'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">transactions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'gum'</span><span class="p">)]</span>

<span class="c1"># Count the number of transactions with cereal and gum</span>
<span class="n">cereal</span> <span class="o">=</span> <span class="n">transactions</span><span class="p">[(</span><span class="n">transactions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'cereal'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">transactions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'gum'</span><span class="p">)]</span>

<span class="c1"># Count the number of transactions with bread and gum</span>
<span class="n">bread</span> <span class="o">=</span> <span class="n">transactions</span><span class="p">[(</span><span class="n">transactions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'bread'</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">transactions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'gum'</span><span class="p">)]</span>

<span class="c1"># Print the counts for each transaction.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'coffee:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coffee</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'cereal:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cereal</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'bread:'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bread</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>coffee: 40
cereal: 25
bread: 20
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Association-Rulesの全ての候補を確認する">
<a class="anchor" href="#Association-Rules%E3%81%AE%E5%85%A8%E3%81%A6%E3%81%AE%E5%80%99%E8%A3%9C%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>Association Rulesの全ての候補を確認する<a class="anchor-link" href="#Association-Rules%E3%81%AE%E5%85%A8%E3%81%A6%E3%81%AE%E5%80%99%E8%A3%9C%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B"> </a>
</h2>
<h3 id="データの準備">
<a class="anchor" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%BA%96%E5%82%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>データの準備<a class="anchor-link" href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%BA%96%E5%82%99"> </a>
</h3>
<p>小売店の併売データを読み込む</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Load transactions from pandas</span>
<span class="n">groceries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./dataset/small_grocery_store.csv'</span><span class="p">)</span>

<span class="c1"># Split transaction strings into lists</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="n">groceries</span><span class="p">[</span><span class="s1">'Transaction'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">))</span>

<span class="c1"># Convert DataFrame column into list of strings</span>
<span class="n">transactions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>

<span class="c1"># Print the list of transactions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[['milk', 'bread', 'biscuit'], ['bread', 'milk', 'biscuit', 'cereal'], ['bread', 'tea'], ['jam', 'bread', 'milk'], ['tea', 'biscuit'], ['bread', 'tea'], ['tea', 'cereal'], ['bread', 'tea', 'biscuit'], ['jam', 'bread', 'tea'], ['bread', 'milk'], ['coffee', 'orange', 'biscuit', 'cereal'], ['coffee', 'orange', 'biscuit', 'cereal'], ['coffee', 'sugar'], ['bread', 'coffee', 'orange'], ['bread', 'sugar', 'biscuit'], ['coffee', 'sugar', 'cereal'], ['bread', 'sugar', 'biscuit'], ['bread', 'coffee', 'sugar'], ['bread', 'coffee', 'sugar'], ['tea', 'milk', 'coffee', 'cereal']]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Association-rulesの生成">
<a class="anchor" href="#Association-rules%E3%81%AE%E7%94%9F%E6%88%90" aria-hidden="true"><span class="octicon octicon-link"></span></a>Association rulesの生成<a class="anchor-link" href="#Association-rules%E3%81%AE%E7%94%9F%E6%88%90"> </a>
</h3>
<p>９つの食料品のリストを抽出し、すべての可能な単独原因単独結果の組み合わせ（Association rules）をitertoolsを使って生成する</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import permutations from the itertools module</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>

<span class="c1"># Define the set of groceries</span>
<span class="n">flattened</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">transactions</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">t</span><span class="p">]</span>
<span class="n">groceries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">flattened</span><span class="p">))</span>

<span class="c1"># Generate all possible rules</span>
<span class="n">rules</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">permutations</span><span class="p">(</span><span class="n">groceries</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># Print the set of rules</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>

<span class="c1"># Print the number of rules</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rules</span><span class="p">),</span><span class="s2">"通り"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[('jam', 'cereal'), ('jam', 'sugar'), ('jam', 'tea'), ('jam', 'orange'), ('jam', 'bread'), ('jam', 'milk'), ('jam', 'coffee'), ('jam', 'biscuit'), ('cereal', 'jam'), ('cereal', 'sugar'), ('cereal', 'tea'), ('cereal', 'orange'), ('cereal', 'bread'), ('cereal', 'milk'), ('cereal', 'coffee'), ('cereal', 'biscuit'), ('sugar', 'jam'), ('sugar', 'cereal'), ('sugar', 'tea'), ('sugar', 'orange'), ('sugar', 'bread'), ('sugar', 'milk'), ('sugar', 'coffee'), ('sugar', 'biscuit'), ('tea', 'jam'), ('tea', 'cereal'), ('tea', 'sugar'), ('tea', 'orange'), ('tea', 'bread'), ('tea', 'milk'), ('tea', 'coffee'), ('tea', 'biscuit'), ('orange', 'jam'), ('orange', 'cereal'), ('orange', 'sugar'), ('orange', 'tea'), ('orange', 'bread'), ('orange', 'milk'), ('orange', 'coffee'), ('orange', 'biscuit'), ('bread', 'jam'), ('bread', 'cereal'), ('bread', 'sugar'), ('bread', 'tea'), ('bread', 'orange'), ('bread', 'milk'), ('bread', 'coffee'), ('bread', 'biscuit'), ('milk', 'jam'), ('milk', 'cereal'), ('milk', 'sugar'), ('milk', 'tea'), ('milk', 'orange'), ('milk', 'bread'), ('milk', 'coffee'), ('milk', 'biscuit'), ('coffee', 'jam'), ('coffee', 'cereal'), ('coffee', 'sugar'), ('coffee', 'tea'), ('coffee', 'orange'), ('coffee', 'bread'), ('coffee', 'milk'), ('coffee', 'biscuit'), ('biscuit', 'jam'), ('biscuit', 'cereal'), ('biscuit', 'sugar'), ('biscuit', 'tea'), ('biscuit', 'orange'), ('biscuit', 'bread'), ('biscuit', 'milk'), ('biscuit', 'coffee')]


72 通り
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h2 id="Metric-&amp;-Pruning">
<a class="anchor" href="#Metric-&amp;-Pruning" aria-hidden="true"><span class="octicon octicon-link"></span></a>Metric &amp; Pruning<a class="anchor-link" href="#Metric-&amp;-Pruning"> </a>
</h2>
<p>全ての可能な組み合わせを候補として置くのは、かなり時間とコストがかかる。<br>
そのため、有用な規則だけに絞りたい。  → <strong>Metric &amp; Pruning Process</strong></p>
<p>①<strong>Metric</strong> : Association rulesにスコアを割り当て</p>
<p>②<strong>Pruning</strong> : 特定の基準に従い、基準に満たさないRulesを放棄する</p>
<h3 id="One-hot-encoding-transaction-data">
<a class="anchor" href="#One-hot-encoding-transaction-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>One-hot encoding transaction data<a class="anchor-link" href="#One-hot-encoding-transaction-data"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import the transaction encoder function from mlxtend</span>
<span class="kn">from</span> <span class="nn">mlxtend.preprocessing</span> <span class="kn">import</span> <span class="n">TransactionEncoder</span>

<span class="c1"># Instantiate transaction encoder and identify unique items</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">TransactionEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>

<span class="c1"># One-hot encode transactions</span>
<span class="n">onehot</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transactions</span><span class="p">)</span>

<span class="c1"># Convert one-hot encoded data to DataFrame</span>
<span class="n">onehot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">onehot</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">columns_</span><span class="p">)</span>

<span class="c1"># Print the one-hot encoded transaction dataset</span>
<span class="nb">print</span><span class="p">(</span><span class="n">onehot</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>    biscuit  bread  cereal  coffee    jam   milk  orange  sugar    tea
0      True   True   False   False  False   True   False  False  False
1      True   True    True   False  False   True   False  False  False
2     False   True   False   False  False  False   False  False   True
3     False   True   False   False   True   True   False  False  False
4      True  False   False   False  False  False   False  False   True
5     False   True   False   False  False  False   False  False   True
6     False  False    True   False  False  False   False  False   True
7      True   True   False   False  False  False   False  False   True
8     False   True   False   False   True  False   False  False   True
9     False   True   False   False  False   True   False  False  False
10     True  False    True    True  False  False    True  False  False
11     True  False    True    True  False  False    True  False  False
12    False  False   False    True  False  False   False   True  False
13    False   True   False    True  False  False    True  False  False
14     True   True   False   False  False  False   False   True  False
15    False  False    True    True  False  False   False   True  False
16     True   True   False   False  False  False   False   True  False
17    False   True   False    True  False  False   False   True  False
18    False   True   False    True  False  False   False   True  False
19    False  False    True    True  False   True   False  False   True
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compute the support</span>
<span class="n">support</span> <span class="o">=</span> <span class="n">onehot</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Print the support</span>
<span class="nb">print</span><span class="p">(</span><span class="n">support</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>biscuit    0.40
bread      0.65
cereal     0.30
coffee     0.40
jam        0.10
milk       0.25
orange     0.15
sugar      0.30
tea        0.35
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Add a jam+bread column to the DataFrame onehot</span>
<span class="n">onehot</span><span class="p">[</span><span class="s1">'jam+bread'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">onehot</span><span class="p">[</span><span class="s1">'jam'</span><span class="p">],</span> <span class="n">onehot</span><span class="p">[</span><span class="s1">'bread'</span><span class="p">])</span>

<span class="c1"># Compute the support</span>
<span class="n">support</span> <span class="o">=</span> <span class="n">onehot</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Print the support values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">support</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>biscuit      0.40
bread        0.65
cereal       0.30
coffee       0.40
jam          0.10
milk         0.25
orange       0.15
sugar        0.30
tea          0.35
jam+bread    0.10
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><br></p>
<p><strong>Additional Reference</strong><br>
JMR生活総合研究所. アップセリング（Up-selling）、クロスセリング（Cross-selling）. <em>マーケティング用語集</em>. <a href="https://www.jmrlsi.co.jp/knowledge/yougo/my06/my0618.html">https://www.jmrlsi.co.jp/knowledge/yougo/my06/my0618.html</a></p>
<hr>
<p><strong>このシリーズの別のポストを見るには</strong></p>
<p>　　　<a href="https://jaysung00.github.io/jays_blog/datacamp/2021/02/09/Basket-analysis-2.html">[Next &gt;&gt;]</a></p>

</div>
</div>
</div>
&lt;/div&gt;
 

</span></p>
</div>
</div></div>
</div>


  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Jaysung00/jays_blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/jays_blog/___%20%20**b.%20marketing**%20____________%20%3E%20datacamp%20class/2021/02/08/Basket-analysis-1.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/jays_blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/jays_blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/jays_blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A study record about Data Science</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/jaysung00" title="jaysung00"><svg class="svg-icon grey"><use xlink:href="/jays_blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
